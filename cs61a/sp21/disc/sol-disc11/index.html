
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="description" content ="CS 61A: Structure and Interpretation of Computer Programs" />
    <meta name="keywords" content ="CS 61A, Computer Science, CS, 61A, Programming, John DeNero, Berkeley, EECS" />
    <meta name="author" content ="Pamela Fox, Paul Hilfinger" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-throttle-debounce/1.1/jquery.ba-throttle-debounce.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="../../assets/js/hl.js"></script>
    <script>
        // we aren't registering builtins since
        //      (1) they don't render differently in the current CSS from other names
        //      (2) it's a mess to list all of them. You can extract from the site but that takes effort
        // if (1) ceases to be true, (2) might be worth the effort. For now, we're leaving as is
        hljsRegister({
            'keyword': "define if cond and or let begin lambda mu quote delay cons-stream set! quasiquote unquote unquote-splicing define-macro"
        });
        hljs.initHighlightingOnLoad();
    </script>
    <script src="../../assets/js/dark-mode.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata|Roboto:300,400,500|Work+Sans:400,700">
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="stylesheet" href="../../assets/css/mono-blue.css">
    <link rel="icon" href="../../assets/images/favicon.ico">

    

<link rel="stylesheet" type="text/css" href="../../assets/css/disc.css">


    <title>
Discussion 11 | CS 61A Spring 2021
</title>
  </head>

  <body id="index" class="home">
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container noselect">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-section">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../index.html">
            <img style="max-width:60px; margin-top: -20px;" class="logo" src="../../assets/images/logo.png"/>
          </a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-section">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="../../weekly/index.html">Weekly Schedule</a></li>
            <li><a href="../../office-hours/index.html">Office Hours</a></li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="index.html#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Staff
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="../../instructor/index.html">Instructors</a></li>
                <li><a href="../../TAs/index.html">TAs</a></li>
                <li><a href="../../tutors/index.html">Tutors</a></li>
                <li><a href="../../academic-interns/index.html">Academic Interns</a></li>
              </ul>
            </li>
            <li><a href="../../resources/index.html">Resources</a></li>
            <li><a href="../../articles/about/index.html">Syllabus</a></li>
            <li><a href="https://piazza.com/berkeley/spring2021/cs61a" target="_blank">Piazza</a></li>
            <li><a href="https://code.cs61a.org">Code</a></li>
            <li><a href="http://tutor.cs61a.org">PyTutor</a></li>
            <li><a href="../../contact/index.html">Contact</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <main id="content" class="container">
      
<div class='row'>
  <div class='col-md-9'>
    <header>
      <h1>
        
Discussion 11: Interpreters

        
        
        <ul class="inline-block list-inline">
          <li><a href="javascript:window.print()" class="label label-outline">disc11.pdf</a></li>
        </ul>
        
        
      </h1>
    </header>
    

<div class="alert storable-login-status"></div>

This is an online worksheet that you can work on during discussions and tutorials.
Your work is not graded and you do not need to submit anything.

    



<h1 id="discussion-11-vitamin">Discussion 11 Vitamin</h1>


<p>To encourage everyone to watch or attend discussion orientation, we have created small discussion vitamins. If you complete 5 of the 6 vitamins, you can earn one point of extra credit added to your final grade in the course. Please answer all of the questions in <a href="https://links.cs61a.org/vitamin-for-disc11">this form</a> by <strong>Thursday at 11:59 PM</strong>.</p>


<h1 id="calculator">Calculator</h1>


<p>An interpreter is a program that understands other programs. Today, we will
explore how to build an interpreter for Calculator, a simple language that uses
a subset of Scheme syntax.</p>

<p>The Calculator language includes only the four basic arithmetic operations:
<code>+</code>, <code>&#x2d;</code>, <code>*</code>, and <code>/</code>. These operations can be nested and can take any numbers
of arguments. A few examples of calculator expressions and their corresponding
values are shown below.</p>

<pre><code class="scheme">calc&gt; (+ 2 2)
4

calc&gt; (&#x2d; 5)
&#x2d;5

calc&gt; (* (+ 1 2) (+ 2 3))
15</code></pre>



<p>The reader component of an interpreter parses input strings and
represents them as data structures in the implementing language. In this case,
we need to represent Calculator expressions as Python objects. To represent
numbers, we can just use Python numbers. To represent the names of the
arithmetic procedures, we can use Python strings (e.g. <code>&#x27;+&#x27;</code>).</p>

<p>Call expressions are a bit more complicated. Like Scheme call expressions,
Calculator call expressions look just like Scheme lists.  For example,
to construct the expression <code>(+ 2 3)</code> in Scheme, we would do the following:</p>

<pre><code class="scheme">scm&gt; (cons &#x27;+ (cons 2 (cons 3 nil)))
(+ 2 3)</code></pre>



<p>To represent Scheme lists in Python, we will use the <code>Pair</code> class.
A <code>Pair</code> instance holds exactly two elements. Accordingly, the <code>Pair</code>
constructor takes in two arguments, and to make a list we must nest calls to
the constructor and pass in <code>nil</code> as the second element of the last pair.
Note that in our implementation, <code>nil</code> is bound to a special user-defined
object that represents an empty list, whereas <code>nil</code> in Scheme is actually
an empty list.</p>

<pre><code>&gt;&gt;&gt; Pair(&#x27;+&#x27;, Pair(2, Pair(3, nil)))
Pair(&#x27;+&#x27;, Pair(2, Pair(3, nil)))</code></pre>



<p>Each <code>Pair</code> instance has two instance attributes: <code>first</code> and <code>rest</code>,
which are bound to the first and second elements of the pair
respectively.</p>

<pre><code>&gt;&gt;&gt; p = Pair(&#x27;+&#x27;, Pair(2, Pair(3, nil)))
&gt;&gt;&gt; p.first
&#x27;+&#x27;
&gt;&gt;&gt; p.rest
Pair(2, Pair(3, nil))
&gt;&gt;&gt; p.rest.first
2</code></pre>



<p><code>Pair</code> is very similar to <code>Link</code>, the class we developed for
representing linked lists -- they have the same attribute names <code>first</code> and <code>rest</code> and are represented very similarly.
<!--
In addition to <code>Pair</code> objects, we include a <code>nil</code> object
to represent the empty list. <code>Pair</code> instances have methods:

<ol>
  <li><code>__len__</code>, which returns the length of the list.</li>
  <li><code>__getitem__</code> which allows indexing into the pair.</li>
  <li><code>map</code>, which applies a function <code>fn</code> to all of the elements in the list.</li>
</ol>

<code>nil</code> also has those methods, for consistency.

-->
Here's an implementation of what we described:</p>

<pre><code>class Pair:
    &quot;&quot;&quot;Represents the built&#x2d;in pair data structure in Scheme.&quot;&quot;&quot;
    def __init__(self, first, rest):
        self.first = first
        if not scheme_valid_cdrp(rest):
            raise SchemeError(&quot;cdr can only be a pair, nil, or a promise but was {}&quot;.format(rest))
        self.rest = rest

    def map(self, fn):
        &quot;&quot;&quot;Maps fn to every element in a list, returning a new
        Pair.

        &gt;&gt;&gt; Pair(1, Pair(2, Pair(3, nil))).map(lambda x: x * x)
        Pair(1, Pair(4, Pair(9, nil)))
        &quot;&quot;&quot;
        assert isinstance(self.rest, Pair) or self.rest is nil, \
            &quot;rest element in pair must be another pair or nil&quot;
        return Pair(fn(self.first), self.rest.map(fn))

    def __repr__(self):
        return &#x27;Pair({}, {})&#x27;.format(self.first, self.rest)</code></pre>



<!--

<pre><code>    def __getitem__(self, i):
        &quot;&quot;&quot;Allows us to index into lists and treat them like Python iterables.

        &gt;&gt;&gt; p = Pair(1, Pair(2, Pair(3, nil)))
        &gt;&gt;&gt; p[1]
        2
        &gt;&gt;&gt; list(p)
        [1, 2, 3]
        &quot;&quot;&quot;
        assert isinstance(self.rest, Pair) or self.rest is nil, \
          &quot;rest element in pair must be another pair or nil&quot;
        if i == 0:
             return self.first
        return self.rest[i &#x2d; 1]

     def __len__(self):
         return 1 + len(self.rest)</code></pre>


-->

<pre><code>class nil:
    &quot;&quot;&quot;Represents the special empty pair nil in Scheme.&quot;&quot;&quot;
    def map(self, fn):
        return nil
    def __getitem__(self, i):
        raise IndexError(&#x27;Index out of range&#x27;)
    def __repr__(self):
        return &#x27;nil&#x27;

nil = nil() # this hides the nil class *forever*</code></pre>



<div class="page-break"></div>


<h2 id="questions">Questions</h2>


<h3 class="question" id="q1">Q1: From Pair to Calculator</h3>

<p>Write out the Calculator expression with proper syntax that
corresponds to the following <code>Pair</code> constructor calls. Also,
draw out a box and pointer diagram corresponding to each input.</p>



<pre><code>&gt;&gt;&gt; Pair(&#x27;+&#x27;, Pair(1, Pair(2, Pair(3, Pair(4, nil)))))</code></pre>




            <label class="sr-only" for="scheme-calculator-exprs1-input">Your Answer:</label>
            <input class="form-control storable" id="scheme-calculator-exprs1-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">

<p><code>&gt; (+ 1 2 3 4)</code></p>

</div>

<pre><code>&gt;&gt;&gt; Pair(&#x27;+&#x27;, Pair(1, Pair(Pair(&#x27;*&#x27;, Pair(2, Pair(3, nil))), nil)))</code></pre>




            <label class="sr-only" for="scheme-calculator-exprs2-input">Your Answer:</label>
            <input class="form-control storable" id="scheme-calculator-exprs2-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">

<p><code>&gt; (+ 1 (* 2 3))</code></p>

</div>

<div class="sol-highlight">
<a href="https://goo.gl/6VKGQX">Box and pointers solutions</a>
<a href="https://youtu.be/zIvYrA76GRo?t=1m59s">Video walkthrough</a>
</div>

<h3 class="question" id="q2">Q2: Using Pair</h3>

<p>Answer the following questions about a <code>Pair</code> instance
representing the Calculator expression <code>(+ (&#x2d; 2 4) 6 8)</code>.</p>



<p>Write out the Python expression that returns a <code>Pair</code> representing the given expression:</p>


            <label class="sr-only" for="calculator-attributes-python-input">Your Answer:</label>
            <input class="form-control storable" id="calculator-attributes-python-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">

<pre><code>&gt;&gt;&gt; Pair(&#x27;+&#x27;, Pair(Pair(&#x27;&#x2d;&#x27;, Pair(2, Pair(4, nil))), Pair(6, Pair(8, nil))))</code></pre>


</div>

<p>Draw a box and pointer diagram corresponding to the Pair:</p>

<pre><code>.
.
.
.</code></pre>



<div class="sol-highlight">
<a href="https://goo.gl/2pxLFY">Box and pointer diagram</a>
</div>

<p>What is the operator of the call expression?</p>


            <label class="sr-only" for="calculator-attributes-operator-input">Your Answer:</label>
            <input class="form-control storable" id="calculator-attributes-operator-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">
+
</div>

<p>If the <code>Pair</code> you constructed in the previous part was bound to the name <code>p</code>,
how would you retrieve the operator?</p>


            <label class="sr-only" for="calculator-attributes-python-operator-input">Your Answer:</label>
            <input class="form-control storable" id="calculator-attributes-python-operator-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">
<code>p.first</code>
</div>

<p>What are the operands of the call expression?</p>


            <label class="sr-only" for="calculator-attributes-operands-input">Your Answer:</label>
            <input class="form-control storable" id="calculator-attributes-operands-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">
An expression (- 2 4), the number 6, the number 8.
</div>

<p>If the <code>Pair</code> you constructed was bound to the name <code>p</code>, how would
you retrieve a list containing all of the operands?</p>


            <label class="sr-only" for="calculator-attributes-python-operands-input">Your Answer:</label>
            <input class="form-control storable" id="calculator-attributes-python-operands-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">
<code>p.rest</code>
</div>

<p>How would you retrieve only the first operand?</p>


            <label class="sr-only" for="calculator-attributes-python-first-operand-input">Your Answer:</label>
            <input class="form-control storable" id="calculator-attributes-python-first-operand-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">
<code>p.rest.first</code>
</div>

<div class="page-break"></div>


<h1 id="evaluation">Evaluation</h1>


<p>The evaluation component of an interpreter determines the type of an expression
and executes corresponding evaluation rules.</p>

<p>Here are the evaluation rules for the three types of Calculator expressions:</p>

<ol>
  <li><strong>Numbers</strong> are self-evaluating, and can be thought of as primitives. For example, the numbers 3.14
  and 165 just evaluate to themselves.</li>
  <li><strong>Names</strong> are looked up in the <code>OPERATORS</code> dictionary.
  In this dictionary, each name (e.g. <code>&#x27;+&#x27;</code>) is bound to a corresponding function in Python
  that does the appropriate operation on a list of numbers (e.g. <code>sum</code>).</li>
  <li><p><strong>Call expressions</strong> are evaluated the same way you've been
  doing them all semester:</p>

  <ol>
    <li><strong>Evaluate</strong> the operator, which evaluates to a function.</li>
    <li><strong>Evaluate</strong> the operands from left to right.</li>
    <li><strong>Apply</strong> the function to the value of the operands.</li>
  </ol></li>
</ol>

<p>The function <code>calc_eval</code> takes in a Calculator expression represented
in Python and implements each of these rules:</p>

<pre><code>def calc_eval(exp):
    &quot;&quot;&quot;Evaluates a Calculator expression represented as a Pair.&quot;&quot;&quot;
    if isinstance(exp, Pair): # Call expressions
        fn = calc_eval(exp.first)
        args = list(exp.rest.map(calc_eval))
        return calc_apply(fn, args)
    elif exp in OPERATORS:    # Names
        return OPERATORS[exp]
    else:                     # Numbers
        return exp</code></pre>



<p><code>calc_eval</code> is recursive! In order to evaluate call
expressions, we must call <code>calc_eval</code> on the operator and each of the
operands.</p>

<p>The <code>apply</code> step in the Calculator language is straight-forward since we only
have primitive procedures. This step will be more complex in the Scheme project
since the procedures may include user-defined procedures.</p>

<p>Given the Python function that implements the appropriate Calculator operation
and a Python list of numbers, the <code>calc_apply</code> function simply calls
the function on the arguments, and regular Python evaluation rules take place.</p>

<pre><code>def calc_apply(fn, args):
    &quot;&quot;&quot;Applies a Calculator operation to a list of numbers.&quot;&quot;&quot;
    return fn(args)</code></pre>



<!--
The <code>*args*</code> syntax expands a list of arguments. For example:

<pre><code>&gt;&gt;&gt; calc_apply(print, [1, 2, 3]) # Becomes print(1, 2, 3), not print([1, 2, 3])
1 2 3</code></pre>


-->


<h2 id="questions-2">Questions</h2>

<h3 class="question" id="q3">Q3: Counting Eval and Apply</h3>

<p>How many calls to <code>calc_eval</code> and <code>calc_apply</code> would it
take to evaluate each of the following Calculator expressions?</p>



<p><code>&gt; (+ 2 4 6 8)</code></p>


            <label class="sr-only" for="counting-eval-apply-1-input">Your Answer:</label>
            <input class="form-control storable" id="counting-eval-apply-1-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">
6 calls to eval: 1 for the entire expression, and then 1 each for the operator
and each operand.

<p>1 call to apply the addition operator.
</div></p>

<p><code>&gt; (+ 2 (* 4 (&#x2d; 6 8)))</code></p>


            <label class="sr-only" for="counting-eval-apply-2-input">Your Answer:</label>
            <input class="form-control storable" id="counting-eval-apply-2-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">
10 calls to eval: 1 for the whole expression, then 1 for each of the operators
and operands. When we encounter another call expression, we have to evaluate
the operators and operands inside as well.

<p>3 calls to apply the function to the arguments for each call expression.</p>

<p><a href="https://youtu.be/ZHPdJzZ3g14">Video Walkthrough</a>
</div></p>

<h3 class="question" id="q4">Q4: New Operators</h3>



<p>Suppose we want to add handling for comparison operators <code>&gt;</code>,
<code>&lt;</code>, and <code>=</code> as well as <code>and</code> expressions to our
Calculator interpreter.  These should work the same way they do in Scheme.</p>

<pre><code class="scheme">calc&gt; (and (= 1 1) 3)
3
calc&gt; (and (+ 1 0) (&lt; 1 0) (/ 1 0))
#f</code></pre>



<p>i. Are we able to handle expressions containing the comparison operators
(such as <code>&lt;</code>, <code>&gt;</code>, or <code>=</code>) with the existing implementation of <code>calc_eval</code>?
Why or why not?</p>


            <label class="sr-only" for="scheme-new-and-existing-handle-input">Your Answer:</label>
            <input class="form-control storable" id="scheme-new-and-existing-handle-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">
Comparison expressions are regular call expressions, so we need to evaluate the
operator and operands and then apply a function to the arguments.  Therefore,
we do not need to change <code>calc_eval</code>. We simply need to add new entries
to the <code>OPERATORS</code> dictionary that map <code>&#x27;&lt;&#x27;</code>, <code>&#x27;&gt;&#x27;</code>, and <code>&#x27;=&#x27;</code>
to functions that perform the appropriate comparison operation.
</div>

<p>ii. Are we able to handle <code>and</code> expressions with the existing
implementation of <code>calc_eval</code>? Why or why not?</p>

<blockquote><p><strong>Hint:</strong> Think about the rules of evaluation we've implemented in <code>calc_eval</code>. Is anything different about <code>and</code>?</p></blockquote>


            <label class="sr-only" for="scheme-new-and-existing-handle-and-input">Your Answer:</label>
            <input class="form-control storable" id="scheme-new-and-existing-handle-and-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">
Since <code>and</code> is a special form that short circuits on the first false-y
operand, we cannot handle these expressions the same way we handle call
expressions.  We need to add special handling for combinations that don't
evaluate all the operands.
</div>

<p>iii. Now, complete the implementation below to handle <code>and</code>
expressions. You may assume the conditional operators (e.g. <code>&lt;</code>, <code>&gt;</code>,
<code>=</code>, etc) have already been implemented for you.</p>


            
            <b>Your Answer</b>
            
            <div class="monaco-storable" id="eval-and-input" style="height:396px;"></div>
            <a href="index.html#" data-toggle="modal" data-target="#modal-eval-and-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-eval-and-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-eval-and-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor('def calc_eval(exp):\n    if isinstance(exp, Pair):\n        if _______________________: # and expressions\n            return eval_and(exp.rest)\n        else:                   # Call expressions\n            return calc_apply(calc_eval(exp.first), list(exp.rest.map(calc_eval)))\n    elif exp in OPERATORS:      # Names\n        return OPERATORS[exp]\n    else:                       # Numbers\n        return exp\n\ndef eval_and(operands):\n    "*** YOUR CODE HERE ***"\n\n', "python", "eval-and-input"));
            </script>
        
            <div class="sol-highlight">
                <b>Solution</b>
                
<pre><code>def calc_eval(exp):
    if isinstance(exp, Pair):
<div class="sol-highlight">        if exp.first == &#x27;and&#x27;: # and expressions</div>            return eval_and(exp.rest)
        else:                   # Call expressions
            return calc_apply(calc_eval(exp.first), list(exp.rest.map(calc_eval)))
    elif exp in OPERATORS:      # Names
        return OPERATORS[exp]
    else:                       # Numbers
        return exp

def eval_and(operands):
<div class="sol-highlight">    curr, val = operands, True
    while curr is not nil:
        val = calc_eval(curr.first)
        if val is False:
            return False
        curr = curr.rest
    return val</div></code></pre>

            </div>
        


<h1 id="interpreters-tutorial-discussions">Interpreters Tutorial Discussions</h1>

<h3 class="question" id="q5">Q5: (Tutorial) Interpreters Review</h3>

<p>Discuss the follow questions with your tutorial group - they will be helpful for your understanding of the Scheme project! If you wish to take notes, we recommend you take notes on a separate document so it won't accidentally get erased.</p>



<p>What are the four parts of an interpreter (Hint: what does REPL stand for)? What does each part do? What parts did you work on implementing in the discussion?</p>


            <label class="sr-only" for="interpreters-disc-1-input">Your Answer:</label>
            <input class="form-control storable" id="interpreters-disc-1-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">
The four parts of an interpreter are read, evaluate, print and loop.

<p>Read takes in the user input code and outputs some data structure representing the expression.</p>

<p>Evaluate takes in this data structure and outputs a value representing what this expression evaluates to. In this step, call expressions, arithmetic expressions, special forms, etc. will all turn into simple values / primitives.</p>

<p>Print takes in however the value returned from the evaluate stage is represented and displays a human-readable form to the user interacting with the interpreter.</p>

<p>Loop simply means loop! We go back to the read stage to execute the next user-inputted line of code.</p>

<p>In this discussion, we worked on Read and Evaluate. In the scheme project you will also be implementing the Read and Evaluate stages of the Scheme Interpreter.
</div></p>

<p>For the Calculator interpreter implemented in discussion, for the following executed code, what would be the input into the "Read" portion of the interpreter?</p>

<pre><code>calc&gt; (+ 2 3)
5</code></pre>



            <label class="sr-only" for="interpreters-disc-2-input">Your Answer:</label>
            <input class="form-control storable" id="interpreters-disc-2-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">

<pre><code>(+ 2 3)</code></pre>


</div>

<p>What would be the output of the "Read" portion for the same code?</p>


            <label class="sr-only" for="interpreters-disc-3-input">Your Answer:</label>
            <input class="form-control storable" id="interpreters-disc-3-input" type="text">
            <div class="storable-status"></div>
        
<div class="sol-highlight">

<pre><code>Pair(&#x27;+&#x27;, Pair(2, Pair(3, nil)))</code></pre>


</div>

<p>How does the evaluate stage work in Calculator? How do we know if an input into <code>calc_eval</code> is a call expression?</p>


            <label class="sr-only" for="interpreters-disc-4-input">Your Answer:</label>
            <input class="form-control storable" id="interpreters-disc-4-input" type="text">
            <div class="storable-status"></div>
        

<div class="sol-highlight">

<p>In the evaluate stage, Pairs are inputted and passed into <code>calc_eval</code> to be turned into values. We know the input is a call expression if it is a Pair. If it's an operator (such as <code>+</code>, <code>&#x2d;</code>, etc), we return the corresponding operator. Else, we know it's a primitive, and so we return itself, since primitives evaluate to themselves.</p>

<p>Very importantly, the evaluate stage is recursive -- in particular, remember the rules of evaluation:</p>

<ol>
  <li>Evaluate the operator, which evaluates to a function.</li>
  <li>Evaluate the operands from left to right.</li>
  <li>Apply the function to the value of the operands.</li>
</ol>

<p>Steps 1 and 2 <strong>recursively</strong> evaluate the operator and operands again!</p>

</div>




<h1 id="scheme-lists">Scheme Lists</h1>


<h3 class="question" id="q6">Q6: (Tutorial) Replicate</h3>

<p>Write a function that takes an element <code>x</code> and a
non-negative integer <code>n</code>, and returns a list with <code>x</code> repeated <code>n</code> times.</p>

<blockquote><p><strong>Tip:</strong> If you aren't sure where to start, try writing the corresponding recursive function for Linked Lists in Python first!</p></blockquote>




            
            <b>Your Answer</b>
            
            <div class="monaco-storable" id="replicate-input" style="height:216px;"></div>
            <a href="index.html#" data-toggle="modal" data-target="#modal-replicate-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-replicate-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-replicate-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor("(define (replicate x n)\n    'YOUR-CODE-HERE\n)\n\n;;; Tests\n(replicate 5 3)\n; expect (5 5 5)\n", "scheme", "replicate-input"));
            </script>
        
            <div class="sol-highlight">
                <b>Solution</b>
                
<pre><code>(define (replicate x n)
<div class="sol-highlight">    (if (= n 0)
        nil
        (cons x (replicate x (&#x2d; n 1)))
    )</div>)

;;; Tests
(replicate 5 3)
; expect (5 5 5)</code></pre>

            </div>
        

<div class="sol-highlight">
<a href="https://youtu.be/8FO2ZYkXwb0?t=3m55s">walkthrough video</a>
</div>

<pre><code class="scheme">scm&gt; (replicate 5 3)
(5 5 5)</code></pre>


<h3 class="question" id="q7">Q7: (Tutorial) Run Length Encoding</h3>
A <strong>run-length encoding</strong> is a method of compressing a sequence
of letters. The list <code>(a a a b a a a a)</code> can be compressed to <code>((a
  3) (b 1) (a 4))</code>, where the compressed version of the sequence keeps track of
how many letters appear consecutively.

<p>Write a function that takes a compressed sequence and expands it into the
original sequence.</p>

<blockquote><p><strong>Hint:</strong> You may want to use <code>my&#x2d;append</code> and <code>replicate</code>.</p></blockquote>

<p><code>my&#x2d;append</code> is implemented as follows, where <code>my&#x2d;append</code> takes in two lists and concatenates them together.</p>

<pre><code class="scheme">(define (my&#x2d;append a b)
    (if (null? a)
    b
    (cons (car a) (my&#x2d;append (cdr a) b))))</code></pre>



<pre><code class="scheme">scm&gt; (my&#x2d;append &#x27;(1 2 3) &#x27;(2 3 4))
(1 2 3 2 3 4)</code></pre>






            
            <b>Your Answer</b>
            
            <div class="monaco-storable" id="uncompress-rle-input" style="height:216px;"></div>
            <a href="index.html#" data-toggle="modal" data-target="#modal-uncompress-rle-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-uncompress-rle-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-uncompress-rle-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor("(define (uncompress s)\n    'YOUR-CODE-HERE\n)\n\n;;; Tests\n(uncompress &#x27;((a 1) (b 2) (c 3)))\n; expect (a b b c c c)\n", "scheme", "uncompress-rle-input"));
            </script>
        
            <div class="sol-highlight">
                <b>Solution</b>
                
<pre><code>(define (uncompress s)
<div class="sol-highlight">    (if (null? s)
    s
    (my&#x2d;append (replicate (car (car s)) (car (cdr (car s))))
            (uncompress (cdr s))))</div>)

;;; Tests
(uncompress &#x27;((a 1) (b 2) (c 3)))
; expect (a b b c c c)</code></pre>

            </div>
        

<div class="sol-highlight">
<a href="https://youtu.be/8FO2ZYkXwb0?t=10m27s">walkthrough video</a>
</div>

<pre><code class="scheme">scm&gt; (uncompress &#x27;((a 1) (b 2) (c 3)))
(a b b c c c)</code></pre>


<h3 class="question" id="q8">Q8: (Tutorial) Map</h3>
Write a function that takes a procedure and applies it to every
element in a given list.


            
            <b>Your Answer</b>
            
            <div class="monaco-storable" id="map-fn-input" style="height:198px;"></div>
            <a href="index.html#" data-toggle="modal" data-target="#modal-map-fn-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-map-fn-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-map-fn-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor("(define (map fn lst)\n    'YOUR-CODE-HERE\n)\n\n;;; Tests\n(map (lambda (x) (* x x)) &#x27;(1 2 3))\n; expect (1 4 9)\n", "scheme", "map-fn-input"));
            </script>
        
            <div class="sol-highlight">
                <b>Solution</b>
                
<pre><code>(define (map fn lst)
<div class="sol-highlight">    (if (null? lst)
        nil
        (cons (fn (car lst)) (map fn (cdr lst))))</div>)

;;; Tests
(map (lambda (x) (* x x)) &#x27;(1 2 3))
; expect (1 4 9)</code></pre>

            </div>
        

<pre><code class="scheme">scm&gt; (map (lambda (x) (* x x)) &#x27;(1 2 3))
(1 4 9)</code></pre>





<h3 class="question" id="q9">Q9: (Tutorial) Make Tree</h3>

<p>Fill in the following to complete an abstract tree data type:</p>


            
            <b>Your Answer</b>
            
            <div class="monaco-storable" id="make-tree-input" style="height:198px;"></div>
            <a href="index.html#" data-toggle="modal" data-target="#modal-make-tree-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-make-tree-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-make-tree-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor("(define (make&#x2d;tree label branches) (cons label branches))\n\n(define (label tree)\n    'YOUR-CODE-HERE\n)\n\n(define (branches tree)\n    'YOUR-CODE-HERE\n)\n", "scheme", "make-tree-input"));
            </script>
        
            <div class="sol-highlight">
                <b>Solution</b>
                
<pre><code>(define (make&#x2d;tree label branches) (cons label branches))

(define (label tree)
<div class="sol-highlight">    (car tree)</div>)

(define (branches tree)
<div class="sol-highlight">    (cdr tree)</div>)</code></pre>

            </div>
        

<h3 class="question" id="q10">Q10: (Tutorial) Tree Sum</h3>
Using the abstract data type above, write a function that sums up the
entries of a tree, assuming that the entries are all numbers.

<blockquote><p><strong>Hint:</strong> you may want to use the <code>map</code> function you defined above, and
also write a helper function for summing up the entries of a list.</p></blockquote>


            
            <b>Your Answer</b>
            
            <div class="monaco-storable" id="tree-sum-input" style="height:162px;"></div>
            <a href="index.html#" data-toggle="modal" data-target="#modal-tree-sum-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-tree-sum-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-tree-sum-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor("(define (tree&#x2d;sum tree)\n    'YOUR-CODE-HERE\n)\n\n'YOUR-CODE-HERE\n\n", "scheme", "tree-sum-input"));
            </script>
        
            <div class="sol-highlight">
                <b>Solution</b>
                
<pre><code>(define (tree&#x2d;sum tree)
<div class="sol-highlight">    (+ (label tree) (sum (map tree&#x2d;sum (branches tree))))</div>)

<div class="sol-highlight">(define (sum lst)
    (if (null? lst) 0 (+ (car lst) (sum (cdr lst)))))</div></code></pre>

            </div>
        

  </div>

  <div class='col-md-3 sticky'>
    <nav class='hidden-print hidden-sm hidden-xs sidebar'>
      <ul>
  <li><a href="index.html#discussion-11-vitamin">Discussion 11 Vitamin</a></li>
  <li><a href="index.html#calculator">Calculator</a></li>
  <ul>
    <li><a href="index.html#questions">Questions</a></li>
    <ul>
      <li><a href="index.html#q1">Q1: From Pair to Calculator</a></li>
      <li><a href="index.html#q2">Q2: Using Pair</a></li>
    </ul>
  </ul>
  <li><a href="index.html#evaluation">Evaluation</a></li>
  <ul>
    <li><a href="index.html#questions-2">Questions</a></li>
    <ul>
      <li><a href="index.html#q3">Q3: Counting Eval and Apply</a></li>
      <li><a href="index.html#q4">Q4: New Operators</a></li>
    </ul>
  </ul>
  <li><a href="index.html#interpreters-tutorial-discussions">Interpreters Tutorial Discussions</a></li>
  <ul>
    <li><a href="index.html#q5">Q5: (Tutorial) Interpreters Review</a></li>
  </ul>
  <li><a href="index.html#scheme-lists">Scheme Lists</a></li>
  <ul>
    <li><a href="index.html#q6">Q6: (Tutorial) Replicate</a></li>
    <li><a href="index.html#q7">Q7: (Tutorial) Run Length Encoding</a></li>
    <li><a href="index.html#q8">Q8: (Tutorial) Map</a></li>
    <li><a href="index.html#q9">Q9: (Tutorial) Make Tree</a></li>
    <li><a href="index.html#q10">Q10: (Tutorial) Tree Sum</a></li>
  </ul>
</ul>
    </nav>
  </div>
</div>

    </main>

    <footer class="container">
      <div class="row text-center">
        <div class="col col-sm-4">
          <h3><a href="../../index.html">CS 61A</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="../../weekly/index.html">Weekly Schedule</a></li>
            <li><a href="../../office-hours/index.html">Office Hours</a></li>
            <li><a href="../../staff/index.html">Staff</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="../../resources/index.html">Resources</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="../../articles/studying/index.html">Studying Guide</a></li>
            <li><a href="../../articles/debugging/index.html">Debugging Guide</a></li>
            <li><a href="../../articles/composition/index.html">Composition Guide</a></li>
            <li><a href="../../articles/pair-programming/index.html">Pair Programming</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="../../articles/about/index.html">Policies</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="../../articles/about/index.html#assignments">Assignments</a></li>
            <li><a href="../../articles/about/index.html#exams">Exams</a></li>
            <li><a href="../../articles/about/index.html#grading">Grading</a></li>
          </ul>
        </div>
      </div>
    </footer>

    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/loader.min.js"></script>
  <link rel="stylesheet" data-name="vs/editor/editor.main" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/editor/editor.main.min.css">
  <script>
      require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs' }});
      window.MonacoEnvironment = { getWorkerUrl: () => URL.createObjectURL(new Blob([`
      self.MonacoEnvironment = {
          baseUrl: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min'
      };
      importScripts('https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/base/worker/workerMain.min.js');
  `], { type: 'text/javascript' }))
  };
  </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsPlumb/2.15.5/js/jsplumb.min.js"></script>
    <script src="../../assets/js/network_storage.js"></script>
    <script src="../../assets/js/storable.js"></script>
    <script src="../../assets/js/editor.js"></script>
    <script src="../../assets/js/env-diagram.js"></script>
    
<script src="../../assets/js/sketchy.js"></script>
<script>
  $('.sidebar ul').addClass('nav nav-stacked noselect');
  $('body').scrollspy({
    target: '.sidebar',
    offset: 40
  });

  function goToId(id) {
    var target = $(id);
    target.parent().show();
    $('html,body').animate({
      scrollTop: target.offset().top,
    }, 100);
    $("body").scrollspy('refresh');
  }

  if (location.hash) {
    setTimeout(function() {
      if (location.hash) {
        goToId(location.hash);
      }
    }, 1);
  }

  $("a").click(function(event) {
    var urlBeforeHashRegEx = new RegExp("^"+window.location.href.split("#")[0]);
    if (/^#/.test(this.hash) && urlBeforeHashRegEx.test(this.href)) {
      event.preventDefault();
      goToId(this.hash);
      document.location.hash = this.hash;
    }
  });
</script>

  </body>
</html>