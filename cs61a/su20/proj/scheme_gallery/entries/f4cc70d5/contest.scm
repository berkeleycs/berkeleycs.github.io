;;; Scheme Recursive Art Contest Entry
;;;
;;; Please do not include your name or personal info in this file.
;;;
;;; Title: Menlo[w] Resolution Font
;;;
;;; Description:
;;;   <9 by 5 not enough,
;;;    should've anti-aliased.
;;;    utf-8 next.>

; Converts a two digit character to a number representing a 9x5 binary grid.
(define (char-value ch)
  (index
`(0 0 141872464000 11349451079680 11372346714432 4935603361732 985632593120 430042696096 4539780431872 2341034266754 8937896218760 719469216 4461826048 6340 32505856 6336 36578796032 499950339520 433930245088 1031906018272 1031914162112 75517364288 1082900121536 498785109440 1066294972672 499875628480 499892913600 6643783872 6643783876 3641052160 1041203200 25972400128 482181513344 500084432398 148530775584 1049648220096 533130133984 981988854656 1082901677024 1082901676544 498773575104 602972669472 1069585404896 241626564032 604139833888 567489872864 613829625376 603230684704 499878774208 1049648185856 499878774209 1049648252448 533127530432 1069585404032 602957989312 602950412416 602958130720 602709247520 602709037184 1066297213920 15676907725070 558618445856 15464099022926 148746797056 31 8935679459328 471320032 567960717248 520634848 35955197408 488620512 107541041280 521714734 567960716832 137845937120 137845936284 567561570848 416750375104 895145632 1025033760 488162752 1025047056 521714721 520634880 520554432 142778437728 588826080 588589184 588967456 581052960 588583064 1042424800 2340899917954 4539918979204 8937963393160 290521088)
  ch)
)

; Colors
(define bg "black")
(define fg "#abb2bf")
(define fg_bold "white")

; Gets the element in lst at index i
(define (index lst i)
  (if (= i 0)
    (car lst)
    (index (cdr lst) (- i 1))
  )
)

; Converts a number x to a list of binary numbers.
(define (bin x)
  (if (= x 0)
    nil
    (append (bin (quotient x 2)) (list (modulo x 2)))
  )
)

; Pads a list to a fixed length.
(define (pad-list lst l)
  (if (< (length lst) l)
    (pad-list (cons 0 lst) l)
    lst
  )
)

; Converts a list of numbers to a single large number.
(define (join lst)
  (define (helper lst prev)
    (if (null? lst)
      prev
      (helper (cdr lst) (+ (car lst) (* prev (expt 10 (+ (floor (log10 (car lst))) 1)))))
    )
  )
  (helper (cdr lst) (car lst))
)

; Move the turtle to a specific position without drawing
(define (move x y)
  (penup)
  (setposition x y)
  (pendown)
)

; Draw a horizontal line from (x, y) to (x + l, y)
(define (underline x y l c)
  (move x y)
  (setheading 90)
  (color c)
  (forward l)
)

; Draw a two digit character at (x, y) in pixelsize units.
(define (draw-char ch x y size color under)
  (define (helper i j)
    (if (< j 9)
      (if (> i 4)
        (helper 0 (+ j 1))
        (begin
          (if (= 1 (index b (+ i (* 5 j))))
            (pixel (+ x i) (- y j) color)
          )
          (helper (+ i 1) j)
        )
      )
    )
  )
  ; skip rendering empty characters for speed
  (if (> (char-value ch) 0)
    (begin
      (define b (pad-list (bin (char-value ch)) 45))
      (pixelsize size)
      (helper 0 0)
    )
  )
  (if under
    (underline (* x size) (* (- y 9) size) (- (* 6 size) 1) color)
  )
)

; Represent strings as a single number,
; where two digits corresponds to a valid character.
; Maximum length is then 24, read from right to left.
; Draw an entire list of strings at a position (x, y).
(define (write x y size color literal s)
  (if (list? s)
    (define s (join s))
  )
  (define (helper s i j color under)
    (define ch  (modulo s 100))
    (define r (quotient s 100))
    (define (change-state color under)
      (helper r i j color under)
    )
    (define (update ch r)
      (draw-char ch (quotient (+ x i) size) (quotient (+ y j) size) size color under)
      (helper r (+ i (* 6 size)) j color under)
    )
    (if (> s 0)
      (cond
        ((= ch 99) ; dummy character to indicate end of string
          (change-state color under)
        )
        ((= ch 0)  ; "\n", jump to newline
          (helper r 0 (- j (* 10 size)) color under)
        )
        (literal   ; interpret everything literally
          (update ch r)
        )
        ((= ch 61) ; "\", interpret next character literally
          (if (= (modulo r 100) 99)
            (define r (quotient r 100))
          )
          (update (modulo r 100) (quotient r 100))
        )
        ((= ch 11) ; "*", make bold
          (change-state (if (eq? color fg) fg_bold fg) under)
        )
        ((= ch 64) ; "_", underline
          (change-state color (not under))
        )
        (else
          (update ch r)
        )
      )
    )
  )
  (helper s 0 0 color #f)
)

(define (draw)
  (bgcolor bg)

  ; fill in portrait canvass
  (move 420 70)
  (begin_fill)
  (color fg_bold)
  (circle 420)
  (end_fill)

  ; write alphabet in top left corner
  (write -490 490 1 fg #t `(99930116106364630961019300111513282705313012142961 99071694339262046010060995020365320800172625242322 99212019180091908988878685848382818079787776757473 99727170696867660059585756555453525150494847464544 9943424140393837363534))

  ; description
  (write -320 -370 2 fg #f `(99647778857315777864617483669166766461688384167283 99801586867286161627818585736401277068838680840142 99423652340000151170687970746884018370858681788068 99110170767477018084776601868090018566738501847081 99807301707352000102848370858681788068017385748801 99727974768380880184908075797001868366737454001414 99141414141414141414141414141414141414141414141414 99141414141414141414141414141414141414141414141414 99141414001511647986727774665101807901867666726644 99018683668053641101788083710111748366916644018683 99667374541101271801708386727439))

  ; Kazari ascii
  (write -390 460 1 bg #t `(99002828010101010101010101010101010101010101010101 99010180101009010101010101010101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010100101101 99010111090101010101010101010101010101010101010101 99010101708477701001010101010169100101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101001083 99160167090101010101010101010101010101010101010101 99010101037961690603010101852884100101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101008301 99010101010116820910831601010101010101010101010101 99010101010101010101018109036806690601690603108501 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010009311410010101671382138109010101010101 99010101010101010101010101010101010179867109730979 99707385101086090101010101010101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010100291090090101097174311469 99100101010101010101010101010101010101019009798671 99097228037961222219796103850101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010100288603690601 99038528108610110101010101010101010101010108281109 99010101010101010101010903690679612049038501010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101010100 99282801010101081719896108308410113364330101010101 99010101010849110901010101010101010101010101010101 99010101857077282801010101010101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010100100928010170798069101070 99798069101010010101010101911274010101010101010101 99010101010101010101010101010101010101119009010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101010015 99010101010101800910820110108909158109661429108909 99010101011581010101010101010101010101010101010101 99010101010101010101010101010101311482010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010010890101010109 99798671097209806910181474098085101801093091010101 99010101010101010101010101010101010101010101010101 99010101010101010101010183807101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101000979740101011090091580308110 99111109857077281074119001010101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010915010101010101010101010101010101 99010101010101010101010101010101010101010101010101 99010100801429100101900915802870798069101010108028 99101101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101010101 99010180480101010101010101010101010101010101010101 99010101010101010101010101010101010101010060110910 99017079806910101074098114291089090101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010115800109 99010101010101010101010101010101010101010101010101 99010101010101010101010100797410101010181482098109 99101018148212010101010101010101010101010101010101 99010101010174118909156909660970847770100101010101 99010101010101010101010101011074011189010101010101 99010101010101010101010101010101010101010101010101 99010101000915690979707385101830820971740930010101 99010101010101010101010101010101010101108209010101 99010101010101010101010110110101010101010101010101 99010101010101100109110981010101010101010101010101 99010101010101010101010101010101010101010068708310 99111109857077098069101801010101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101010114 99860980851001010101010101181401010101010101010101 99010101010101010101010100180930890183807109797410 99101701010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101091569091086090101 99010170766678010101010101010101010101010101010101 99010101003080101111098570770101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010109797410106709010115800930010101 99010101010101010101010101010101010101010069101114 99110901010101010185707701010101010101090101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101011429106709150180097974 99100101010101910101010101010101010101010101010100 99127411900930670101101101011109857077010980690101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101011018140101010101 99010101010101010101010101010101017409808510172810 99090930910101838071090101010101010101010101010101 99010100806910101809148601010109808501011730901011 99010101011601010101010101010101010101010101010101 99010101010101010101010101010101010101016780010101 99010101010101010101010101010101010101110901838071 99282810807612748313669101010101010101010101010101 99010101010012741310868312010101010101016676090979 99740101109001010101010101010101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010113890930 99107483136691136676091301010101010101010101010101 99010101010100100101011011110910010101010101018076 99137413868301090901010101010101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101018570773090010101010101010101 99108909661011110985707728287601010101010101010101 99010101010101010101001070096628751001010188090101 99662828820101010101011069101010171517232001010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101010968 99099010010101010101010101890981311410901389097986 99710910010173010101010101010101010101010101010009 99311410690979867109733010018209108109010101016610 99111109857077282810011010010101010101010101101814 99910915750901010101010101010101010101010101010101 99010101010101010101011010910915750910690901010109 99010170847770101010101709157509010101101001010101 99010101010101010101010100790966151290138931141090 99138909798671010109816678091010181484010915010101 99750101010101096909797073850101010101010101010101 99010101010101010101010101010101010101010110173091 99097174311410010101910901017986710910840971137411 99740101013010760101010101010101010101010101001383 99098570772828101010760915111010910966090910100967 99090183311401011001010101019109798671098401010101 99710101010101010101010101010101010101010101010101 99010101013075101111098570772828010110100101011009 99671512901376151110010101011091010101010101010101 99010101010100096609151210096701151289091011110931 99141091097986710910840971301090091089090101018301 99010101857077282810106210181491091501010101010101 99010101010101010101010101010101010101018228109109 99158228101814019109150101011011110981281091091581 99010101016075090101010101010101010101010100708477 99701062101017091582098328101817148409158228101017 99091581098328101801010114840101010915816075097970 99738510173091010101010101010101010101010101010101 99010101010101010109717401013114109109017986710101 99010109108409713082108109101101010811096901010101 99010101010101010101008570772828109013107909661512 99890979741081093010901389098570773001010101011081 99010109831011110985707728281010760101010101010101 99010101010101010101010101010101010101010915161010 99790966090983010101010101308410111109857077282810 99100117151710010101010101010101010101010090098513 99151710890985097974109109843010901389098570770979 99740101010101011017152115168001010915121009673114 99010101010101010101010101010101010101010101010101 99010162609310811512800910820101010101010109852810 99093114822727108109017385748801010101010101010101 99010101001074097368856678308010740985016870831011 99110985707730100101010101010101910975101163110985 99707728281076010101010101010101010101010101010101 99010101010101010101011511191517090101010101010101 99151401101021151715117609680930100967101101010101 99010101010101010101001109857077282810098574797464 99717770841551282885747974010101010101010101010113 99748370857413837085740130107101010101010101010101 99010101010101010101010101010101010101010101010101 99011301010172137309857077282810111817110971857974 99838101010101010101010101010100157185797483491385 99668077711551301085136809857077010101010101010101 99010101010101012828102423181301010101010101010101 99010101010101010101010101010101010101010101010101 99010101012518190101131819190962101090098910171810 99221520151101010101010101010101010101006809690972 99096071287362101090098910171810681511152201010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101010101 99010101010101010109690972096071289110900989102225 99181322251813202019010962010101010101010101010010 99212415251413212615241409281018251525211413252615 99182001010101140101010101010101010101010101010101 99010101010101010101010101101101010101010101016501 99010101010101140101010101110909281021221525211413 99251715242009281010212315231409011301010101010101 99010100192115211809606210222515181814131920152614 99092810202015192201011413101165010101010101010101 99010101010101010101010118010101171817190101010101 99010101110901010121261521201409281018221518221413 99182515262009281017192215251410111109010101130101 99010101010101002119152218096085301091099010890988 99101111098570772828101010180114820910810969010101 99010101010101010901010101010127271001011091097974 99840101010101011511810101011310910984806815111011 99110981097974101082096609151164861511191517010101 99013091010101010101010085707709708477706260797073 99851017308209717430821081096910111109687083101111 99098570772828109109901089010910010101010124201913 99232019132120190901010101016210100101011923151714 99091319261518140928102121151819141324211521140928 99101101010101010193010101010101010093010111091019 99211522191413241524180928101920151813232115190960 99621017221519141310110108110901011725151814092810 99171915211901141310252415211401010101090928100101 99172315241914131823152618092810222415171413172619 99152009601085010101010101010930010101010101001001 99010101019109109009108909701011110985707728281010 99108010690971287310670971288062816071090101010179 99740101010110690969731545108809308110110101011109 99857077097974108209861310810986301069136709857077 99097974109109901089090101010101010175300101010101 99010086010101010101018570773010910910900910890910 99800910820910810985101111098570772828101010220901 99010110670901010109797410101814710967092727101001 99011010800985091010740985097079746778806815450979 99741010820981101010861010900101010101011511800101 99010101010015120101010101010101891511680913109001 99151168151489151180093114109013890979867109880979 99741069010109797484010113106909848068301068138009 99857077010979741017151725181516648615111069151210 99171519241511101071096609090909300169010185707701 99090101010101010010110101010101010101012501010180 99010101151109720984301080137409857077097084777062 99607970738510010117307109017174301071096710111109 99687083101101110985707709797410670910101068151190 99091310681511890909311410901389097986710988010101 99013086010101010101008570773001010101010101010167 99010101011069098210810975101124241811098570772828 99626031146493626960011710740979741010101010862727 99109010890988090910181291097409797410730910720988 99137210710988301090138909857077097974010101010110 99010101101130140101010100110969090101010101010110 99010182010101010101098813821067098813671081098830 99107313721371098570770979741017152123151610891514 99900915111010910966091512890930901089098810111109 99857077097084777010108609877083151011010101010128 99011109014509010101010101007970738501010101011001 99012123010101309109717430861091097410111109687083 99101111098570773114626928822867288160738574881089 99097368856678301089098510118011098570772828671082 99151290138115128931141090138909798671010101010901 99018830108209010101010101008110670972010110110101 99010128010125011511098570772828891010107079806910 99101010101010093114104209738574881010101088107114 99790971101073091580098728881018127209171010730915 99800987097084777010881071140101010172090101017110 99107309158001010101010100098709797073850101010101 99100101720101302971097174097974109009701310761089 99096909701310891075096709703010731372137109857077 99097974107609751086093089101111098570770990838509 99797410101089098110010101010101016901097084777010 99820901890101010110006909797073850101010101010101 99010101101089091066090971740901797410820981107809 99308910111845110985707709708477701081097970738510 99821081098509717430821081096910111109687083101111 99098570770901010101010101797410100101108209891001 99010101010101006709708477701089090181100101010101 99010101010167090101010179707385010101101089096609 99717409797401821081097830891011110985707709708477 99701082097970738510821081098509717430821081096710 99111109687083010101010101018570770901010101797410 99100110820101010100108909862810090101010101010101 99013114420101010101010101738574880101011089100101 99810986099083852810090970847770108909797073851010 99890966097174097974108209108109783089101111098570 99770970847770100101010101010110420101010101097084 99746683010109010101001011010101010128650101010162 99010101601109010101010101010101797073850101100101 99821081098509717430821081098610111109687083101111 99098570770979741070847766710931146493101010820101 99010101010101010101010101010110010101010101810901 99010101830979740101010100101001010101016910010101 99016701010109830901010101010101010170847770010110 99010124243018097970738510109013890967108609109109 99097174093114692727679380109013890910860991311410 99010101010101010101010101010101016201010101010160 99090101010173857488010101010010740101010101097368 99856678010101010101013074010101010101108609010183 99101101019311096870831011110985707709708477701070 99847766710979707385101090138909811080099109717409 99010101010101010101010101311482010101010101272781 99010101010101272701010101010100108009010173857488 99107309010101010101017368856678301089096601018570 99770979741084091066093090101111098570770980691010 99221517010101010101011512820983010109808510108109 99010101010101010101010183090130840101838071090101 99017974010101011001010101010100900975131089097530 99100101010101010101821381090101010101131076137509 99857077097974107309843010901389098570773114101101 99010101010108010101110973010179867109837085741501 99010101010101010101101111090101010145308801010110 99890901010171010101010101008570772828171519151610 99010101010182151281090101010101308201010110810901 99010101010101017810111109857077010101012828100101 99010901010101010101010101010101012828106910810901 99010101010190010101010101010101091511010110821081 99098901010101010101000929108210810990091511106910 99810989093001010101106901010101010901010101010101 99010101018210810101010101010101010109910185707728 99281001018101016979840915141001010101010101010110 99820101010101010101010969798409010101010101010101 99010101010030821081099010111109857077282810100101 99018109858471090101010101010115140101010101010101 99010101100101010101010101010101011082091085847101 99010909010101308210810901010101010101010189101101 99010101010111098570772828420101010101010101010101 99010100101164110979807485817068897001011011010101 99011511092828690101109085747974717974010101010101 99010101010101010101010101010101011511151814101101 99016901011501806711090101010101010101011390857479 99747179740910108210890101010101010101010101010101 99010100098966780101010101010101010101011381108909 99010101010101017974780101010101010101010101010101 99010101010101093114010101891082010101010101138109 99010101010101010179867109010101018571707764697780 99710101010101010101010101010101010015453010690975 99010101010101010101018570772828010101010101010101 99010101010122151701010101010101010101291081010101 99010101010101010101010101011514820101010109308210 99810985010101018570770128281011010101010101010101 99010101010101001109011001010101010101010182101111 99097084777001010101010101011001010110820101090101 99010101010101011279097970738510010101011017092901 99010101018209717409797410790969807801010110100101 99010101010101010101010101010101010101010081010101 99098301010101010928100930821011801109857077301081 99010101010109700101010101010101010101010101857077 99010101010128286801011511171522241310262318132126 99181321191809010101010101010101010101010101010101 99010101010100100101017909107909897483856678647076 99667801010101010101010101010101010101010101010101 99010130010101010110010101010101761380098570772828 99010101010101010101010101010101010101010101010101 99010101010101010101007880697966513051010101017077 99866980780101010101010101010101282874010101010101 99010101010111010186131074090101010101016628100930 99107913680101010101010101010101010101010101010101 99010101010101010101010101000985707701010101010128 99288166781545130101010101010101010177777471130101 99010101010101857477818415453010881301010187138401 99010985707728280101010101010101010101010101010101 99010101010101010101010101010100101001010101011715 99180101010101011409101517010919796685660913708566 99687986838513856680777101010101010101131010170901 99010101010101010101010101010101010101010101010101 99010101010100131713170913211317172030010101010164 99861383136613731374138601857077282801010101010101 99010101858474450101010101010101010101010101010101 99010101010101010101010101003045010101017077866980 99780101010101010110111109019066838334010101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010100797081 99800101010101010101101180130101012424180101010101 99010101010101010101010101010101010101010101010101 99010101010101010101010101010101010101010101010013 99010101010101110901010101010101010101010101010101 99010101010101010101010101010101010101010101010101 9901010101010101010101010100))

  (hideturtle)
  (exitonclick)
)

; Please leave this last line alone.  You may add additional procedures above
; this line.
(draw)
