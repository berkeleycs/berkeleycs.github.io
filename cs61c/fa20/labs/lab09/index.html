




<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    



 <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      extensions: ["tex2jax.js"],
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
      },
      "HTML-CSS": { fonts: ["TeX"] }
    });
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script> 


    <!-- <link rel="stylesheet" href="/assets/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="http://cs61c.org/assets/bootstrap.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="http://cs61c.org/assets/open-iconic-bootstrap.min.css" crossorigin="anonymous">
    <link href='http://cs61c.org/assets/fontawesome/css/all.css' rel='stylesheet'>
    <link rel="stylesheet" href="http://cs61c.org/assets/open-sans.css" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="/assets/theme/main.css" crossorigin="anonymous" id="theme"> -->
    <link rel="stylesheet" href="http://cs61c.org/assets/theme/main.css" crossorigin="anonymous">
    <link rel="stylesheet" href="http://cs61c.org/assets/theme/main_dark.css" crossorigin="anonymous">
    <link rel="stylesheet" href="http://cs61c.org/assets/theme/switch.css" crossorigin="anonymous">
    <link rel="stylesheet" href="http://cs61c.org/assets/syntax.css" crossorigin="anonymous">
    <link rel="shortcut icon" type="image/png" href="http://cs61c.org/assets/favicon.png">
    <link href="http://cs61c.org/assets/open-iconic-bootstrap.min.css" rel="stylesheet">
    <link href="http://cs61c.org/assets/bootstrap-toc.min.css" rel="stylesheet">
    <link href="http://cs61c.org/assets/fullcalendar.min.css" rel="stylesheet">
    <link href="http://cs61c.org/assets/jquery-ui.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
    <!-- <link href="/assets/fullcalendar/packages/core/main.min.css" rel="stylesheet"> -->
    <link href="http://cs61c.org/assets/fullcalendar/packages/daygrid/main.min.css" rel="stylesheet">
    <link href="http://cs61c.org/assets/fullcalendar/packages/timegrid/main.min.css" rel="stylesheet">
    <link href="http://cs61c.org/assets/fullcalendar/packages/list/main.min.css" rel="stylesheet">
    <link href="http://cs61c.org/assets/fullcalendar/packages/bootstrap/main.min.css" rel="stylesheet">

    <title> CS 61C </title>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-154217821-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-154217821-1');
    </script>
    
    <script>
    var loc = window.location.href + '';
    if (loc.indexOf('http://') == 0 && !["localhost", "127.0.0.1"].includes(window.location.hostname)){
        window.location.href = loc.replace('http://','https://');
    }
    var baseurl = "";
    </script>

  </head>
  <body>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="http://cs61c.org/assets/jquery.min.js" crossorigin="anonymous"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script> -->
    <script src="http://cs61c.org/assets/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="http://cs61c.org/assets/bootstrap-toc.min.js"></script>
    <script src="http://cs61c.org/assets/moment.min.js"></script>
    <script src="http://cs61c.org/assets/fullcalendar.min.js"></script>
    <script src="http://cs61c.org/assets/fullcalendar-gcal.js"></script>
    <script type="text/javascript" src="http://cs61c.org/assets/fullcalendar/packages/core/main.min.js"></script>
    <script type="text/javascript" src="http://cs61c.org/assets/fullcalendar/packages/daygrid/main.min.js"></script>
    <script type="text/javascript" src="http://cs61c.org/assets/fullcalendar/packages/timegrid/main.min.js"></script>
    <script type="text/javascript" src="http://cs61c.org/assets/fullcalendar/packages/list/main.min.js"></script>
    <script type="text/javascript" src="http://cs61c.org/assets/fullcalendar/packages/google_calendar/main.min.js"></script>
    <script type="text/javascript" src="http://cs61c.org/assets/fullcalendar/packages/bootstrap/main.min.js"></script>
    <!-- <script type="text/javascript" src="/assets/fullcalendar/packages/moment/main.js"></script>
    <script type="text/javascript" src="/assets/fullcalendar/packages/moment-timezone/main.js"></script> -->



    <div class="wrapper bg-white">
        <nav class="navbar bg-dark navbar-dark navbar-expand-md align-items-center">
            <div class="container">
                <a class="navbar-brand brand-berkeley" href="http://cs61c.org/fa20">
                  <img src = "http://cs61c.org/assets/icon-small.png" class="img-fluid" /> CS 61C
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
                </button>
            
                <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
                  <ul class="navbar-nav">
                      
                      
                        


    <li class="nav-item ">
    <a class="nav-link "
         href="http://cs61c.org/fa20/calendar" >
        Calendar
        
    </a>
    </li>


                      
                        


    <li class="nav-item ">
    <a class="nav-link "
         href="http://cs61c.org/fa20/staff" >
        Staff
        
    </a>
    </li>


                      
                        


    <li class="nav-item ">
    <a class="nav-link "
         href="http://cs61c.org/fa20/policies" >
        Policies
        
    </a>
    </li>


                      
                        


    <li class="nav-item ">
    <a class="nav-link  text-muted "
         target = "_blank" href="https://piazza.com/" >
        Piazza
        
        <span class="oi oi-external-link"></span> 
        
    </a>
    </li>


                      
                        


    <li class="nav-item ">
    <a class="nav-link  text-muted "
         target = "_blank" href="https://oh.cs61c.org" >
        OH Queue
        
        <span class="oi oi-external-link"></span> 
        
    </a>
    </li>


                      
                      
                        


    <li class="nav-item ">
    <a class="nav-link  text-muted "
         target = "_blank" href="https://venus.cs61c.org/" >
        Venus
        
        <span class="oi oi-external-link"></span> 
        
    </a>
    </li>


                      
                        


    <li class="nav-item ">
    <a class="nav-link "
         href="http://cs61c.org/resources/" >
        Resources
        
    </a>
    </li>


                      
                        


    <li class="nav-item ">
    <a class="nav-link "
         href="http://cs61c.org/?redirect=false" >
        Semesters
        
    </a>
    </li>


                      

                      <li class="nav-item" align="center">
                        <label class="switch">
                        <input type="checkbox" id="themeSwitch" onload="if (returnThemeBasedOnLocalStorage() === 'dark') {this.clicked = true;}" onclick="enableTheme(this.checked === false ? 'light' : 'dark', true);">
                          <span class="slider round"></span>
                        </label>
                        <br>
                        <label for="themeSwitch" id="switch_text">Dark Mode</label>
                      </li>
                  </ul>
                </div>
            </div>
          </nav>
      
          <div class="container">
              <h1 class="mb-4">Lab 09</h1>


    <div class="row">
        <div class="col-sm-9">
            <p>Deadline: EOD Friday, November 13</p>

<h2 id="objectives">Objectives:</h2>
<ul>
  <li>TSW learn about and use various SIMD functions to perform data level parallelism</li>
  <li>TSW write code to SIMD-ize certain functions</li>
  <li>TSW learn about loop-unrolling and why it works</li>
</ul>

<h2 id="setup">Setup</h2>
<p>Pull Lab 09 files from the lab starter repository with</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git pull starter master
</code></pre></div></div>

<h2 id="disclaimer">Disclaimer</h2>

<p><strong>NOTE THAT ALL CODE USING SSE INSTRUCTIONS IS GUARANTEED TO WORK ON THE HIVE MACHINES AND IT MAY NOT WORK ELSEWHERE</strong></p>

<p>Many newer processors support SSE intrinsics, so it is certainly possible that your machine will be sufficient, but you may not see accurate speedups. Ideally, you should ssh into one of the hive machines to run this lab. Additionally, many of the performance characteristics asked about later on this lab are more likely to show up on the Hive.</p>

<h2 id="exercise-1---familiarize-yourself-with-the-simd-functions">Exercise 1 - Familiarize Yourself with the SIMD Functions</h2>

<p>Given the large number of available SIMD intrinsics we want you to learn how to find the ones that you’ll need in your application.</p>

<p>For this mini-exercise, we ask you to look at the <a href="https://software.intel.com/sites/landingpage/IntrinsicsGuide/">Intel Intrinsics Guide</a>. Open this page and once there, click the checkboxes for everything that begins with “SSE”.</p>

<p>Look through the possible instructions and syntax structures, then try to find the 128-bit intrinsics for the following operations:</p>

<ul>
  <li>Four floating point divisions in single precision (i.e. float)</li>
  <li>Sixteen max operations over signed 8-bit integers (i.e. char)</li>
  <li>Arithmetic shift right of eight signed 16-bit integers (i.e. short)</li>
</ul>

<p>Hint: Things that say “epi” or “pi” deal with integers, and those that say “<strong>ps</strong>” or “<strong>pd</strong>” deal with <strong>s</strong> ingle <strong>p</strong> recision and <strong>d</strong> ouble <strong>p</strong> recision floats.</p>

<p>You can visualize how the vectors and the different functions work together by inputting your code into the code environment at this <a href="https://piotte13.github.io/SIMD-Visualiser/#/">link</a>!
Another interesting tool that might help you understand the behavior of SIMD instructions is the <a href="https://godbolt.org/z/J7HXBk">Compiler Explorer</a> project. It can also provide a lot of insights when you need to optimize any code in the future.</p>

<p>General advice on working with SIMD instructions:</p>
<ul>
  <li>
    <p>Be ware of memory alignment. For example, <code class="language-plaintext highlighter-rouge">_m256d _mm256_load_pd (double const * mem_addr)</code> would not work with unaligned data – you would need <code class="language-plaintext highlighter-rouge">_m256d _mm256_loadu_pd</code>. Meanwhile, it is almost always desireable to keep your data aligned (can be achieved using special memory allocation APIs). 
In fact, when the data is aligned, aligned load/store will give identical performance to an aligned store. Aligned loads can be folded into other operations as a memory operand which reduces code size and throughput slightly.
 Modern CPUs have very good support for unaligned loads, but there’s still a significant performance hit when a load crosses a cache-line boundary.</p>
  </li>
  <li>
    <p>Recall various CPU pipeline hazards you have learned earlier this semester. Data hazards can drastically hurt performance. That being said, you may want to check data dependencies in adjacent SIMD operations if not getting the desired performance.</p>
  </li>
</ul>

<h2 id="exercise-2---writing-simd-code">Exercise 2 - Writing SIMD Code</h2>

<h3 id="common-mistakes">Common Mistakes</h3>

<p>The following are bugs that the staff have noticed which were preventing students from passing the tests (bold text is what you should not do):</p>

<ul>
  <li><strong>Trying to store your sum vector into a <code class="language-plaintext highlighter-rouge">long long int</code> array</strong>. Use an int array. <strong>Side note: why??</strong> The return value of this function is indeed a <code class="language-plaintext highlighter-rouge">long long int</code>, but that’s because an <code class="language-plaintext highlighter-rouge">int</code> isn’t big enough to hold the sum of all the values across all iterations of the outer loop. However, it is big enough to hold the sum of all the values across a single iteration of the outer loop. This means you’ll want to store your sum vector into an <code class="language-plaintext highlighter-rouge">int</code> array after every iteration of the outer loop and add the total sum to the final result <code class="language-plaintext highlighter-rouge">result</code>.</li>
  <li><strong>Re-initializing your sum vector</strong>. Make sure when you add to your running sum vector; <strong>you are not</strong> declaring a new sum vector!!</li>
  <li><strong>Forgetting the CONDITIONAL in the tail case.</strong> What condition have we been checking before adding something to the sum?</li>
  <li><strong>Adding to an UNINITIALIZED array.</strong> If you add stuff to your result array without initializing it, you are adding stuff to garbage, which makes the array still garbage! Using <code class="language-plaintext highlighter-rouge">storeu</code> before adding stuff is okay though.</li>
</ul>

<p>We’ve got one file <code class="language-plaintext highlighter-rouge">simd.c</code> that has some code to sum the elements of a really big array. It’s a minor detail that it randomly does this <code class="language-plaintext highlighter-rouge">1 &lt;&lt; 16</code> times… but you don’t need to worry about that. We also pince the execution of the code between two timestamps (that’s what the <code class="language-plaintext highlighter-rouge">clock()</code> function does) to measure how fast it runs! The file <code class="language-plaintext highlighter-rouge">test_simd.c</code> is the one which will have a <code class="language-plaintext highlighter-rouge">main</code> function to run the <code class="language-plaintext highlighter-rouge">sum</code> functions.</p>

<h3 id="task">Task</h3>

<p>We ask you to vectorize/SIMDize the code in <code class="language-plaintext highlighter-rouge">simd.c</code> to speed up the naive implementation of <code class="language-plaintext highlighter-rouge">sum()</code>.</p>

<p>You only need to vectorize the inner loop with SIMD! You will also need to use the following intrinsics:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">__m128i _mm_setzero_si128()</code> - returns a 128-bit zero vector</li>
  <li><code class="language-plaintext highlighter-rouge">__m128i _mm_loadu_si128(__m128i *p)</code> - returns 128-bit vector stored at pointer p</li>
  <li><code class="language-plaintext highlighter-rouge">__m128i _mm_add_epi32(__m128i a, __m128i b)</code> - returns vector (a_0 + b_0, a_1 + b_1, a_2 + b_2, a_3 + b_3)</li>
  <li><code class="language-plaintext highlighter-rouge">void _mm_storeu_si128(__m128i *p, __m128i a)</code> - stores 128-bit vector a into pointer p</li>
  <li><code class="language-plaintext highlighter-rouge">__m128i _mm_cmpgt_epi32(__m128i a, __m128i b)</code> - returns the vector (a_i &gt; b_i ? <code class="language-plaintext highlighter-rouge">0xffffffff : 0x0</code> for <code class="language-plaintext highlighter-rouge">i</code> from 0 to 3). AKA a 32-bit all-1s mask if a_i &gt; b_i and a 32-bit all-0s mask otherwise</li>
  <li><code class="language-plaintext highlighter-rouge">__m128i _mm_and_si128(__m128i a, __m128i b)</code> - returns vector (a_0 &amp; b_0, a_1 &amp; b_1, a_2 &amp; b_2, a_3 &amp; b_3), where &amp; represents the bit-wise and operator</li>
</ul>

<p>Start with the code in <code class="language-plaintext highlighter-rouge">sum()</code> and use SSE intrinsics to implement the <code class="language-plaintext highlighter-rouge">sum_simd()</code> function.</p>

<p>How do I do this?</p>

<p>Recall that the SSE intrinsics are basically functions which perform operations on multiple pieces of data in a vector in parallel. This turns out to be faster than running through a for loop and applying the operation once for each element in the vector.</p>

<p>In our sum function, we’ve got a basic structure of iterating through an array. On every iteration, we add an array element to a running sum. To vectorize, you should add a few array elements to a sum vector in parallel and then consolidate the individual values of the sum vector into our desired sum at the end.</p>

<ul>
  <li>Hint 1: <code class="language-plaintext highlighter-rouge">__m128i</code> is the data type for Intel’s special 128-bit vector. We’ll be using them to encode 4 (four) 32-bit ints.</li>
  <li>Hint 2: We’ve left you a vector called <code class="language-plaintext highlighter-rouge">_127</code> which contains four copies of the number 127. You should use this to compare with some stuff when you implement the condition within the sum loop.</li>
  <li>Hint 3: DON’T use the store function (<code class="language-plaintext highlighter-rouge">_mm_storeu_si128</code>) until after completing the inner loop! It turns out that storing is very costly and performing a store in every iteration will actually cause your code to slow down. However, if you wait until after the outer loop completes you may have overflow issues.</li>
  <li>Hint 4: It’s bad practice to index into the <code class="language-plaintext highlighter-rouge">__m128i</code> vector like they are arrays. You should store them into arrays first with the <code class="language-plaintext highlighter-rouge">storeu</code> function, and then access the integers elementwise by indexing into the array.</li>
  <li>Hint 5: READ the function declarations in the above table carefully! You’ll notice that the loadu and storeu take <code class="language-plaintext highlighter-rouge">__m128i*</code> type arguments. You can just cast an int array to a <code class="language-plaintext highlighter-rouge">__m128i</code> pointer. Alternatively, you could skip the typecast at the cost of a bunch of compiler warnings.</li>
</ul>

<p>To compile and run your code, run the following commands:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>make simd
<span class="gp">$</span><span class="w"> </span>./simd
</code></pre></div></div>

<p>Sanity check: The naive version runs at about 7 seconds on the hive machines, and your SIMDized version should run in about 1-2 seconds.</p>

<h2 id="exercise-3---loop-unrolling">Exercise 3 - Loop Unrolling</h2>

<p><strong>Concept Time!</strong> Another tactic used to increase performance is to unroll our for loops! By performing more operations per iteration of the for loop, we have to loop less and not have to waste as many cycles (think about why we would have to waste some cycles?). Theoretically, code would be faster if we didn’t create loops and just copy pasted the loop <code class="language-plaintext highlighter-rouge">n</code> times, but that’s not a very pretty function.</p>

<p>For example, consider this very simple example that adds together the first n elements of an array <code class="language-plaintext highlighter-rouge">arr</code>:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">total</span> <span class="o">+=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The corresponding assembly code might look something like this:</p>

<pre><code class="language-asm">		add t0, x0, x0
		add t1, x0, x0 // Initialize loop counter
loop: 	beq t0, a1, end // Assume register a1 contains the size n of the array
		slli t2, t1, 2
		add t2, t1, a0 // Assume register a0 contains a pointer to the beginning of the array
		lw t3, 0(t2) // Load arr[i] into t3
		add t0, t3, t0 // total += arr[i]
		addi t1, t1, 1 // Increment the loop counter
		jal x0, loop
end: 	...
</code></pre>

<p>If we unroll the loop 4 times, this would be our equivalent code, with a tail case for the situations where n is not a multiple of 4:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">+=</span><span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">total</span> <span class="o">+=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
	<span class="n">total</span> <span class="o">+=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	<span class="n">total</span> <span class="o">+=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">];</span>
	<span class="n">total</span> <span class="o">+=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">total</span> <span class="o">+=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div></div>

<p>For the unrolled code, the corresponding assembly code might look something like this:</p>
<pre><code class="language-asm">      add t0, x0, x0
      add t1, a1, x0 // Assume register a1 contains the size n of the array
      srli t1, t1, 2
      slli t1, t1, 2 // Find largest of multiple 4 &lt;= n
      add t2, x0, x0 // Initialize loop counter
loop: beq t2, t1, tail
      slli t3, t2, 2
      add t3, t3, a0 // Assume register a0 contains a pointer to the beginning of the array
      lw t4, 0(t3) // Load arr[i] into t3
      add t0, t4, t0 // total += arr[i]
      lw t4, 4(t3) // Load arr[i + 1] into t3
      add t0, t4, t0
      lw t4, 8(t3), t0 // Load arr[i + 2] into t3
      add t0, t4, t0
      lw t4, 12(t3), // Load arr[i + 3] into t3
      add t0, t4, t0
      addi t2, t2, 4 // Increment the loop counter
      jal x0, loop
tail: beq t2, a1, end
      slli t3, t2, 2
      lw t4, 0(t3)
      add t0, t4, t0
      addi t2, t2, 1
end: ...
</code></pre>

<p>To obtain even more performance improvement, carefully unroll the SIMD vector sum code that you created in the previous exercise to create <code class="language-plaintext highlighter-rouge">sum_simd_unrolled()</code>. This should get you a little more increase in performance from <code class="language-plaintext highlighter-rouge">sum_simd</code> (a few fractions of a second). As an example of loop unrolling, consider the supplied function <code class="language-plaintext highlighter-rouge">sum_unrolled()</code></p>

<h3 id="task-1">Task</h3>

<p>Within <code class="language-plaintext highlighter-rouge">simd.c</code>, copy your <code class="language-plaintext highlighter-rouge">sum_simd()</code> code into <code class="language-plaintext highlighter-rouge">sum_simd_unrolled()</code> and unroll it 4 (four) times. Don’t forget about your tail case!</p>

<p>To compile and run your code, run the following commands:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>make simd
<span class="gp">$</span><span class="w"> </span>./simd
</code></pre></div></div>

<h2 id="checkoff">Checkoff</h2>
<p>Please submit to the <strong>Lab Autorgrader</strong> assignment.</p>

<p>In your check-in, feel free to explain your implementation of <code class="language-plaintext highlighter-rouge">sum_simd()</code> and <code class="language-plaintext highlighter-rouge">sum_simd_unrolled()</code>.  How much faster did the SIMD code run over the naive implementation? How much of a performance boost did unrolling provide (and why did it increase performance)?</p>

        </div>
        <div class="col-sm-3">
            <nav id="toc" class="sticky-top" style="top: 40px;"></nav>
        </div>
    </div>
    
    <script>
        $(function() {
            var navSelector = "#toc";
            var $myNav = $(navSelector);
            Toc.init($myNav);
            $("body").scrollspy({
                target: navSelector
            });
        });
    </script>


          </div>
    </div>

    <footer class="page-footer">
        <ul class="nav justify-content-center">
            <li class="nav-item">
                <a class="nav-link text-secondary" href="http://cs61c.org/fa20">
                  CS 61C
                </a>
              </li>
            
            
              

<li class="nav-item">
    <a class="nav-link "  href="http://cs61c.org/fa20/calendar" >
      Calendar
    </a>
  </li>

            
              

<li class="nav-item">
    <a class="nav-link "  href="http://cs61c.org/fa20/staff" >
      Staff
    </a>
  </li>

            
              

<li class="nav-item">
    <a class="nav-link "  href="http://cs61c.org/fa20/policies" >
      Policies
    </a>
  </li>

            
              

<li class="nav-item">
    <a class="nav-link  text-dark "  href="https://piazza.com/" >
      Piazza
    </a>
  </li>

            
              

<li class="nav-item">
    <a class="nav-link  text-dark "  href="https://oh.cs61c.org" >
      OH Queue
    </a>
  </li>

            
            
              

<li class="nav-item">
    <a class="nav-link  text-dark "  href="https://venus.cs61c.org/" >
      Venus
    </a>
  </li>

            
              

<li class="nav-item">
    <a class="nav-link "  href="http://cs61c.org/resources/" >
      Resources
    </a>
  </li>

            
              

<li class="nav-item">
    <a class="nav-link "  href="http://cs61c.org/?redirect=false" >
      Semesters
    </a>
  </li>

            

            <li class="nav-item">
              <a class="nav-link text-secondary" href="index.html#">
                Back to top
              </a>
            </li>
        </ul>
    </footer>

    <script type="text/javascript" src="http://cs61c.org/assets/theme/theme.js"></script>
  </body>
</html>
