




<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    



 <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$','$']]
      }
    });
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> 

    <!-- <link rel="stylesheet" href="/assets/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="../../../assets/bootstrap.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="../../../assets/open-iconic-bootstrap.min.css" crossorigin="anonymous">
    <link href='../../../assets/fontawesome/css/all.css' rel='stylesheet'>
    <link rel="stylesheet" href="../../../assets/open-sans.css" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="/assets/theme/main.css" crossorigin="anonymous" id="theme"> -->
    <link rel="stylesheet" href="../../../assets/theme/main.css" crossorigin="anonymous">
    <link rel="stylesheet" href="../../../assets/theme/main_dark.css" crossorigin="anonymous">
    <link rel="stylesheet" href="../../../assets/theme/switch.css" crossorigin="anonymous">
    <link rel="stylesheet" href="../../../assets/syntax.css" crossorigin="anonymous">
    <link rel="shortcut icon" type="image/png" href="../../../assets/favicon.png">
    <link href="../../../assets/open-iconic-bootstrap.min.css" rel="stylesheet">
    <link href="../../../assets/bootstrap-toc.min.css" rel="stylesheet">
    <link href="../../../assets/fullcalendar.min.css" rel="stylesheet">
    <link href="../../../assets/jquery-ui.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
    <!-- <link href="/assets/fullcalendar/packages/core/main.min.css" rel="stylesheet"> -->
    <link href="../../../assets/fullcalendar/packages/daygrid/main.min.css" rel="stylesheet">
    <link href="../../../assets/fullcalendar/packages/timegrid/main.min.css" rel="stylesheet">
    <link href="../../../assets/fullcalendar/packages/list/main.min.css" rel="stylesheet">
    <link href="../../../assets/fullcalendar/packages/bootstrap/main.min.css" rel="stylesheet">

    <title> CS 61C </title>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-154217821-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-154217821-1');
    </script>
    
    <script>
    var loc = window.location.href + '';
    if (loc.indexOf('http://') == 0 && !["localhost", "127.0.0.1"].includes(window.location.hostname)){
        window.location.href = loc.replace('http://','https://');
    }
    var baseurl = "";
    </script>

  </head>
  <body>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="../../../assets/jquery.min.js" crossorigin="anonymous"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script> -->
    <script src="../../../assets/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="../../../assets/bootstrap-toc.min.js"></script>
    <script src="../../../assets/moment.min.js"></script>
    <script src="../../../assets/fullcalendar.min.js"></script>
    <script src="../../../assets/fullcalendar-gcal.js"></script>
    <script type="text/javascript" src="../../../assets/fullcalendar/packages/core/main.min.js"></script>
    <script type="text/javascript" src="../../../assets/fullcalendar/packages/daygrid/main.min.js"></script>
    <script type="text/javascript" src="../../../assets/fullcalendar/packages/timegrid/main.min.js"></script>
    <script type="text/javascript" src="../../../assets/fullcalendar/packages/list/main.min.js"></script>
    <script type="text/javascript" src="../../../assets/fullcalendar/packages/google_calendar/main.min.js"></script>
    <script type="text/javascript" src="../../../assets/fullcalendar/packages/bootstrap/main.min.js"></script>
    <!-- <script type="text/javascript" src="/assets/fullcalendar/packages/moment/main.js"></script>
    <script type="text/javascript" src="/assets/fullcalendar/packages/moment-timezone/main.js"></script> -->



    <div class="wrapper bg-white">
        <nav class="navbar bg-dark navbar-dark navbar-expand-md align-items-center">
            <div class="container">
                <a class="navbar-brand brand-berkeley" href="https://cs61c.org/su20">
                  <img src = "../../../assets/icon-small.png" class="img-fluid" /> CS 61C
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
                </button>
            
                <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
                  <ul class="navbar-nav">
                      
                      
                        


    <li class="nav-item ">
    <a class="nav-link "
         href="../../calendar.html" >
        Calendar
        
    </a>
    </li>


                      
                        


    <li class="nav-item ">
    <a class="nav-link "
         href="../../staff.html" >
        Staff
        
    </a>
    </li>


                      
                        


    <li class="nav-item ">
    <a class="nav-link "
         href="../../policies.html" >
        Policies
        
    </a>
    </li>


                      
                        


    <li class="nav-item ">
    <a class="nav-link  text-muted "
         target = "_blank" href="https://piazza.com/" >
        Piazza
        
        <span class="oi oi-external-link"></span> 
        
    </a>
    </li>


                      
                      
                        


    <li class="nav-item ">
    <a class="nav-link  text-muted "
         target = "_blank" href="https://venus.cs61c.org/" >
        Venus
        
        <span class="oi oi-external-link"></span> 
        
    </a>
    </li>


                      
                        


    <li class="nav-item ">
    <a class="nav-link "
         href="https://cs61c.org/resources/" >
        Resources
        
    </a>
    </li>


                      
                        


    <li class="nav-item ">
    <a class="nav-link "
         href="https://cs61c.org/?redirect=false" >
        Semesters
        
    </a>
    </li>


                      

                      <li class="nav-item" align="center">
                        <label class="switch">
                        <input type="checkbox" id="themeSwitch" onload="if (returnThemeBasedOnLocalStorage() === 'dark') {this.clicked = true;}" onclick="enableTheme(this.checked === false ? 'light' : 'dark', true);">
                          <span class="slider round"></span>
                        </label>
                        <br>
                        <label for="themeSwitch" id="switch_text">Dark Mode</label>
                      </li>
                  </ul>
                </div>
            </div>
          </nav>
      
          <div class="container">
              <h1 class="mb-4">Lab 08</h1>


    <div class="row">
        <div class="col-sm-9">
            <p>Deadline: EOD (End of Day) Friday, July 24th</p>

<h2 id="objectives">Objectives:</h2>
<ul>
  <li>The student would explore the workings of virtual memory, specifically the TLB and the Page Table.</li>
  <li>The student would be able to analyze TLB hit rate and Page Table hit rate and figure out what accesses optimize these values.</li>
</ul>

<h2 id="setup">Setup</h2>

<p>There is no starter code to pull. Follow the instructions below to download the software necessary to complete this lab.</p>

<p>For this lab we will mostly be using the virtual memory simulation features of Camera, a cache and virtual memory simulator. You may also find the cache simulations interesting, however we won’t be working with those here. Unfortunately, Camera is known to have issues when trying to run it on the Hive or Linux machines, so it’s recommend to download Camera from <a href="lab08resources/Camera.jar">here</a>, and simply double click on the jar file to run it on your own (non-Linux) laptop. If you’re on a Mac, you may need to go to “Security &amp; Privacy” in your settings and click “Open Anyway” to allow Camera to run. Some displays don’t seem to play nice with the standard Camera app, if the values in memory are all squished together, try running this version of <a href="lab08resources/CameraHDPI.jar">Camera</a>. If you are unable to find a way to get Camera working on a machine, please partner up with someone who does.</p>

<p>Once Camera opens up, select the virtual memory option to open a visualization of the virtual memory system. In the top left you can see the contents of physical memory. Just below that is a listing of all the pages of virtual memory for this process. To the right of these items are the contents of the TLB and the Page Table. At this point these should all be empty as we haven’t done anything yet. Read about the statistics of your memory system in the “PROGRESS UPDATE” box at the bottom of the window. This area will keep you updated on your status through the simulation as it progresses. You can move the simulation forward, backward or start it over from the beginning using the buttons to the right of the “PROGRESS UPDATE” box.</p>

<h2 id="exercise-0---sanity-check">Exercise 0 - Sanity Check</h2>

<p>Before you continue, <strong>MAKE SURE THAT YOU OPENED THE VM SIMULATOR AND NOT THE CACHE SIMULATOR</strong>.</p>

<h2 id="exercise-1---working-with-camera">Exercise 1 - Working with CAMERA</h2>

<p>Click the button labeled “Auto Generate Add. Ref. Str.” at the right-hand side of the window. This will generate a set of ten address references. You can think of these as a series of RISC-V “load word” instructions reading from the memory address specified. Click the button labeled “Next” to begin the simulation.</p>

<p>For the rest of this exercise you are at the mercy of the “PROGRESS UPDATE” box. After each click of the “Next” button examine the contents of the box and the current state of the memory system. Try to really get an understanding of what is going on in the TLB, the Page Table, and Physical Memory at each step.</p>

<p>Once you have reached the end of the simulation note the number of TLB Hits and Misses and Page Hits and Faults. Write these numbers down, along with the sequence of memory accesses used to show to your TA during checkoff.</p>

<h3 id="checkpoint">Checkpoint</h3>

<ul>
  <li>Given the way the address was broken down, how big are the pages in this model?</li>
  <li>How many TLB Hits and Misses did we have for the randomly generated set of ten addresses? What about for Page Hits and Page Faults?</li>
  <li>Did you have any Page Hits? Explain why. Can you think of a set of ten addresses that would result in a Page Hit?</li>
  <li>Explain the process by which we turn a virtual address into a physical address for the very first access (emphasizing on TLB Misses and Page Faults).</li>
</ul>

<h2 id="exercise-2---misses">Exercise 2 - Misses</h2>

<p>Now that you’ve seen what a random workload looks like in the VM system let’s try creating a custom workload with a specific property. Your goal for this exercise is to create a workload of ten memory accesses that will cause ten TLB misses and ten Page Faults. You should be able to come up with such a workload on paper, but then you should run it in CAMERA to verify your work. You can specify a custom workload in CAMERA by clicking the button labeled “Self Generate Add. Ref. Str.” and entering in the addresses you want to reference one at a time. When you are satisfied that you’ve got a valid sequence write it down and be ready to show it to your TA during checkoff.</p>

<h3 id="checkpoint-1">Checkpoint</h3>

<ul>
  <li>Demonstrate that your ten memory accesses results in ten TLB Misses and ten Page Faults. Explain why such behavior occurs.</li>
</ul>

<h2 id="exercise-3---fixing-our-faults">Exercise 3 - Fixing our Faults</h2>

<p>Given your sequence of memory accesses from Exercise 2, can you find a change to a single parameter (e.g. TLB size, page table size, memory size, etc…) that would result in the same number (ten) of TLB misses but result in fewer than ten page faults? Work through this on paper and be ready to show your results to your TA during checkoff.</p>

<h3 id="checkpoint-2">Checkpoint</h3>

<ul>
  <li>Explain the single parameter change that would result in ten TLB misses, but <strong>fewer</strong> than ten page faults.</li>
</ul>

<h2 id="exercise-4---bringing-it-all-together">Exercise 4 - Bringing it All Together</h2>

<p>We used VMSIM, another Virtual Memory simulator, to create this question. You have two options for this exercise.</p>

<ul>
  <li>Watch this <a href="lab08resources/vm.webm">webm</a> of a VMSIM simulation.</li>
  <li>Use the <code class="language-plaintext highlighter-rouge">appletviewer</code> command in your Terminal like so (doesn’t work on Hive):</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ appletviewer https://denninginstitute.com/workbenches/vmsim/vm.html 
</code></pre></div></div>

<p>Observe what is happnening and answer the following questions:</p>

<p>What is different about the setup of the system in this question as compared to the setup in CAMERA? In particular, what are P1, P2, P3, and P4? If you watch closely you’ll see that this simulation reports a much higher percentage of TLB misses than random runs on CAMERA did. Why might this be? (If you have trouble following the simulation, use the <code class="language-plaintext highlighter-rouge">appletviewer</code> and turn down the speed using the slider on the bottom right.)</p>

<h3 id="checkpoint-3">Checkpoint</h3>

<ul>
  <li>Explain why there is a much higher percentage of TLB misses in this simulation</li>
</ul>

<hr />

<h2 id="checkoffs">Checkoffs</h2>

<p>Similar to last week, there will be no autograded portion of this lab! Just be able to answer the following questions and explain them to your TA:</p>

<p>Exercise 0</p>
<ul>
  <li>None</li>
</ul>

<p>Exercise 1</p>
<ul>
  <li>Explain the answers to the questions on TLB and Page hits and misses to the TA</li>
  <li>Explain the process for turning a virtual address into a physical address for the very first memory access</li>
</ul>

<p>Exercise 2</p>
<ul>
  <li>Demonstrate your memory accesses</li>
  <li>Explain why this behavior occurs</li>
</ul>

<p>Exercise 3</p>
<ul>
  <li>Explain the single parameter change</li>
</ul>

<p>Exercise 4</p>
<ul>
  <li>Explain the much higher percentage of TLB misses</li>
</ul>


        </div>
        <div class="col-sm-3">
            <nav id="toc" class="sticky-top" style="top: 40px;"></nav>
        </div>
    </div>
    
    <script>
        $(function() {
            var navSelector = "#toc";
            var $myNav = $(navSelector);
            Toc.init($myNav);
            $("body").scrollspy({
                target: navSelector
            });
        });
    </script>


          </div>
    </div>

    <footer class="page-footer">
        <ul class="nav justify-content-center">
            <li class="nav-item">
                <a class="nav-link text-secondary" href="https://cs61c.org/su20">
                  CS 61C
                </a>
              </li>
            
            
              

<li class="nav-item">
    <a class="nav-link "  href="../../calendar.html" >
      Calendar
    </a>
  </li>

            
              

<li class="nav-item">
    <a class="nav-link "  href="../../staff.html" >
      Staff
    </a>
  </li>

            
              

<li class="nav-item">
    <a class="nav-link "  href="../../policies.html" >
      Policies
    </a>
  </li>

            
              

<li class="nav-item">
    <a class="nav-link  text-dark "  href="https://piazza.com/" >
      Piazza
    </a>
  </li>

            
            
              

<li class="nav-item">
    <a class="nav-link  text-dark "  href="https://venus.cs61c.org/" >
      Venus
    </a>
  </li>

            
              

<li class="nav-item">
    <a class="nav-link "  href="https://cs61c.org/resources/" >
      Resources
    </a>
  </li>

            
              

<li class="nav-item">
    <a class="nav-link "  href="https://cs61c.org/?redirect=false" >
      Semesters
    </a>
  </li>

            

            <li class="nav-item">
              <a class="nav-link text-secondary" href="index.html#">
                Back to top
              </a>
            </li>
        </ul>
    </footer>

    <script type="text/javascript" src="../../../assets/theme/theme.js"></script>
  </body>
</html>
